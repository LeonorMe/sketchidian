{
  "version": 3,
  "sources": ["src/main.ts", "src/views/DrawingView.ts", "src/drawing/CanvasManager.ts", "src/drawing/tools/PenTool.ts", "src/drawing/ToolManager.ts"],
  "sourcesContent": ["import { Plugin } from \"obsidian\";\r\nimport { DrawingView, DRAWING_VIEW_TYPE } from \"./views/DrawingView\";\r\n\r\nexport default class SketchWhiteboardPlugin extends Plugin {\r\n\r\n    async onload() {\r\n        this.registerView(\r\n            DRAWING_VIEW_TYPE,\r\n            (leaf) => new DrawingView(leaf)\r\n        );\r\n\r\n        this.addCommand({\r\n            id: \"open-sketch-whiteboard\",\r\n            name: \"Open Sketch Whiteboard\",\r\n            callback: () => this.openWhiteboard()\r\n        });\r\n    }\r\n\r\n    async openWhiteboard() {\r\n        const leaf = this.app.workspace.getLeaf(\"tab\");\r\n\r\n        await leaf.setViewState({\r\n            type: DRAWING_VIEW_TYPE,\r\n            active: true,\r\n            state: {}\r\n        });\r\n\r\n        this.app.workspace.revealLeaf(leaf);\r\n    }\r\n\r\n}\r\n", "import { ItemView, WorkspaceLeaf } from \"obsidian\";\r\nimport { CanvasManager } from \"../drawing/CanvasManager\";\r\nimport { ToolManager } from \"../drawing/ToolManager\";\r\n\r\n\r\n\r\nexport const DRAWING_VIEW_TYPE = \"sketch-whiteboard-view\";\r\n\r\nexport class DrawingView extends ItemView {\r\n    canvasManager!: CanvasManager;\r\n    toolManager!: ToolManager;\r\n\r\n    constructor(leaf: WorkspaceLeaf) {\r\n        super(leaf);\r\n    }\r\n\r\n    getViewType() {\r\n        return DRAWING_VIEW_TYPE;\r\n    }\r\n\r\n    getDisplayText() {\r\n        return \"Sketch Whiteboard\";\r\n    }\r\n\r\n    async onOpen() {\r\n        const content = this.contentEl;\r\n        content.empty();\r\n\r\n        content.style.width = \"100%\";\r\n        content.style.height = \"100%\";\r\n        content.style.position = \"relative\";\r\n\r\n        this.canvasManager = new CanvasManager(content);\r\n        this.canvasManager.initialize();\r\n\r\n        this.toolManager = new ToolManager(this.canvasManager);\r\n        this.toolManager.bindEvents();\r\n    }\r\n\r\n}\r\n\r\n", "export interface CanvasLayer {\r\n    canvas: HTMLCanvasElement;\r\n    ctx: CanvasRenderingContext2D;\r\n}\r\n\r\nexport class CanvasManager {\r\n    container: HTMLElement;\r\n    boardEl!: HTMLDivElement;\r\n    layers: CanvasLayer[] = [];\r\n    activeLayerIndex = 0;\r\n\r\n    constructor(container: HTMLElement) {\r\n        this.container = container;\r\n    }\r\n\r\n    initialize() {\r\n        this.boardEl = document.createElement(\"div\");\r\n        this.boardEl.className = \"sketch-board\";\r\n        this.container.appendChild(this.boardEl);\r\n\r\n        for (let i = 0; i < 3; i++) {\r\n            const canvas = document.createElement(\"canvas\");\r\n            canvas.className = \"sketch-layer\";\r\n            canvas.style.touchAction = \"none\";\r\n\r\n            const ctx = canvas.getContext(\"2d\");\r\n            if (!ctx) throw new Error(\"No 2D context\");\r\n\r\n            this.boardEl.appendChild(canvas);\r\n            this.layers.push({ canvas, ctx });\r\n        }\r\n\r\n        this.resize();\r\n        window.addEventListener(\"resize\", () => this.resize());\r\n    }\r\n\r\n    resize() {\r\n        const rect = this.boardEl.getBoundingClientRect();\r\n        const dpr = window.devicePixelRatio || 1;\r\n\r\n        for (const layer of this.layers) {\r\n            const { canvas, ctx } = layer;\r\n\r\n            canvas.width = rect.width * dpr;\r\n            canvas.height = rect.height * dpr;\r\n\r\n            canvas.style.width = rect.width + \"px\";\r\n            canvas.style.height = rect.height + \"px\";\r\n\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n            ctx.scale(dpr, dpr);\r\n\r\n            ctx.lineCap = \"round\";\r\n            ctx.lineJoin = \"round\";\r\n            ctx.globalAlpha = 1;\r\n            ctx.globalCompositeOperation = \"source-over\";\r\n        }\r\n    }\r\n\r\n    getActiveCtx(): CanvasRenderingContext2D {\r\n        return this.layers[this.activeLayerIndex].ctx;\r\n    }\r\n\r\n    getBoardRect(): DOMRect {\r\n        return this.boardEl.getBoundingClientRect();\r\n    }\r\n}\r\n", "import { Tool } from \"./Tool\";\r\n\r\nexport class PenTool implements Tool {\r\n    name = \"pen\";\r\n    color = \"#f0ebe3\";\r\n    size = 2;\r\n\r\n    private lastX = 0;\r\n    private lastY = 0;\r\n\r\n    onDown(ctx: CanvasRenderingContext2D, x: number, y: number) {\r\n        this.lastX = x;\r\n        this.lastY = y;\r\n    }\r\n\r\n    onMove(ctx: CanvasRenderingContext2D, x: number, y: number) {\r\n        ctx.strokeStyle = this.color;\r\n        ctx.lineWidth = this.size;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(this.lastX, this.lastY);\r\n        ctx.lineTo(x, y);\r\n        ctx.stroke();\r\n\r\n        this.lastX = x;\r\n        this.lastY = y;\r\n    }\r\n\r\n    onUp() { }\r\n}\r\n", "import { CanvasManager } from \"./CanvasManager\";\r\nimport { Tool } from \"./tools/Tool\";\r\nimport { PenTool } from \"./tools/PenTool\";\r\n\r\nexport class ToolManager {\r\n    cm: CanvasManager;\r\n    tool: Tool;\r\n    drawing = false;\r\n\r\n    constructor(cm: CanvasManager) {\r\n        this.cm = cm;\r\n        this.tool = new PenTool();\r\n    }\r\n\r\n    bindEvents() {\r\n        const board = this.cm.boardEl;\r\n\r\n        board.addEventListener(\"pointerdown\", this.onDown);\r\n        board.addEventListener(\"pointermove\", this.onMove);\r\n        board.addEventListener(\"pointerup\", this.onUp);\r\n        board.addEventListener(\"pointerleave\", this.onUp);\r\n        board.addEventListener(\"pointercancel\", this.onUp);\r\n    }\r\n\r\n    onDown = (e: PointerEvent) => {\r\n        if (e.button !== 0) return;\r\n\r\n        const rect = this.cm.getBoardRect();\r\n        const x = e.clientX - rect.left;\r\n        const y = e.clientY - rect.top;\r\n\r\n        this.drawing = true;\r\n        this.tool.onDown(this.cm.getActiveCtx(), x, y);\r\n    };\r\n\r\n    onMove = (e: PointerEvent) => {\r\n        if (!this.drawing) return;\r\n\r\n        const rect = this.cm.getBoardRect();\r\n        const x = e.clientX - rect.left;\r\n        const y = e.clientY - rect.top;\r\n\r\n        this.tool.onMove(this.cm.getActiveCtx(), x, y);\r\n    };\r\n\r\n    onUp = () => {\r\n        if (!this.drawing) return;\r\n        this.drawing = false;\r\n        this.tool.onUp(this.cm.getActiveCtx());\r\n    };\r\n}\r\n"],
  "mappings": "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",
  "names": ["import_obsidian"]
}
